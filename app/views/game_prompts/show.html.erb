<%= turbo_stream_from "rooms:#{@current_room.id}:nav-updates" %>
<%= render "shared/leave_game_button" %>

<div class="min-h-screen flex items-center max-sm:items-start justify-center bg-page overflow-auto">
  <div class="card-primary animate-slide-up p-10 m-10 max-sm:p-6 max-sm:m-4 max-w-2xl w-full flex flex-col flex-1 min-h-0">

    <div class="text-center p-8 max-sm:p-6 mb-8 bg-accent-blue/10 rounded-2xl border-2 border-ink/10">
      <div class="text-6xl max-sm:text-5xl mb-4 animate-float">ðŸ’­</div>
      <h2 class="text-2xl max-sm:text-xl font-bold text-ink mb-3 leading-snug"><%= @game_prompt.prompt.description %></h2>
      <p class="text-base max-sm:text-sm text-ink/60 italic">Next, players vote on their favorite answer</p>
    </div>

    <div data-controller="auto-submitter"
         data-auto-submitter-duration-value="<%= @current_room.current_game.next_game_phase_time - GameConstants::COUNTDOWN_FORGIVENESS_SECONDS - Time.now %>"
         data-auto-submitter-display-at-value="<%= @current_room.current_game.next_game_phase_time - GameConstants::COUNTDOWN_FORGIVENESS_SECONDS - 10.seconds %>">
      <%= form_with url: "/answer", method: :post, class: "flex flex-col gap-6" do |form| %>
        <%= form.hidden_field :prompt_id, required: true, value: @game_prompt.id %>

        <div class="flex flex-col gap-2">
          <label for="answer-text" class="form-label">Answer</label>
          <%= form.text_area :text,
              id: "answer-text",
              required: true,
              autocomplete: "off",
              placeholder: "...",
              value: @existing_answer&.text,
              maxlength: Answer::ANSWER_MAX_LENGTH,
              class: "form-input min-h-24" %>
        </div>

        <% if @current_room&.current_game&.next_game_phase_time %>
          <div class="hidden text-center text-sm text-gray-500 italic" data-auto-submitter-target="container">
            Auto-submitting
            <span class="font-semibold" data-auto-submitter-target="display">in 10</span>
          </div>
        <% end %>

        <%= form.submit "Submit Answer", class: "btn-primary", data: { controller: "loading-button" } %>
      <% end %>
    </div>
  </div>
</div>
