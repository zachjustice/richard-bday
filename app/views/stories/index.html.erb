<%# app/views/stories/index.html.erb %>
<div class="max-w-[1400px] w-full flex flex-col flex-1 p-8 md:p-4 m-auto">
  <div class="flex justify-between items-center mb-8 flex-wrap gap-4">
    <h1 class="text-3xl font-bold text-ink m-0">Stories</h1>
    <div class="flex gap-4">
      <%= link_to "Create New Story", new_story_path, class: "btn-primary" %>
      <%= link_to "Prompts", prompts_index_path, class: "btn-secondary" %>
    </div>
  </div>

  <div class="flex flex-col flex-1 overflow-y-auto min-h-0 gap-6 border-2 border-ink/20 p-2 z-1 rounded-lg scroll-fade-indicators">
    <% @stories.each do |story| %>
      <div class="story-card">
        <div class="flex flex-1 flex-col gap-2">
          <div class="flex items-center gap-3 flex-wrap">
            <h3 class="m-0 text-ink font-semibold"><%= story.title %></h3>
            <% unless story.published %>
              <span class="px-2 py-0.5 rounded text-xs font-bold bg-ink/10 text-ink/60">Draft</span>
            <% end %>
            <% story.genres.each do |genre| %>
              <span class="tag text-xs"><%= genre.name %></span>
            <% end %>
          </div>
          <p class="text-ink/60 text-sm m-0">
            <%= pluralize(story.blanks.count, "blank") %>
            <% if story.author.present? %>
              <span class="text-ink/40">Â· by <%= story.author.username %></span>
            <% end %>
          </p>
        </div>

        <div class="flex gap-4 shrink items-start">
          <%= link_to "View", story_path(story), class: "btn-secondary" %>
          <% if story.owned_by?(current_editor) %>
            <%= link_to "Edit", edit_story_path(story), class: "btn-secondary" %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
