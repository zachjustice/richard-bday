<div class="status-page-spacing results-container">
  <div class="results-card">
    <% if winners.size == 1 %>
      <div class="winner-announcement">
        <div class="winner-icon">üèÜ</div>
        <h2 class="winner-text">Winner: <%= winners.first.user.name %></h2>
      </div>
    <% elsif winners.size > 1 %>
      <div class="tie-announcement">
        <div class="tie-icon">ü§ù</div>
        <h2 class="tie-text">It's a Tie!</h2>
        <p class="tie-players">Winner chosen randomly</p>
        <p class="tie-players"><%= winners.map {|w| 
        "#{w.user.name}#{w.id == winner.id ? '*' : ''}"
        }.join(' ‚Ä¢ ') %></p>
      </div>
    <% end %>

    <div class="results-section">
      <h3>Answers</h3>
      <div class="answers-list">
        <% answers_by_id.each do |id, answer| %>
          <div class="answer-card <%= winners.include?(answer) ? 'answer-winner' : '' %>">
            <div class="answer-text-and-author">
              <span class="answer-text"><%= answer.text %> <%= winner.id == id  ? 'üèÜ' : '' %></span>
              <span class="answer-author"><%= answer.user.name %></span>
            </div>
            <div class="answer-meta">
              <% if votes_by_answer[id]&.any? %>
                <div class="answer-voters">
                  <% if votes_by_answer[id]&.count == 0 %>
                    <span class="voters-label">0 Votes</span>
                  <% else%>
                    <div class="voters-tags">
                      <% votes_by_answer[id].each do |vote| %>
                        <span class="voter-tag"><%= vote.user.name %></span>
                      <% end %>
                    </div>
                  <% end%>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <%= form_with url: "/rooms/#{room.id}/next", method: :post, class: "next-form" do |form| %>
      <%= form.submit "Next Round", class: "next-button" %>
    <% end %>
  </div>
</div>
