# frozen_string_literal: true

require "digest"
require "set"

# SHA256-hashed slur list for content filtering.
# Only hate speech/slurs are blocked - profanity and drug references are allowed.
#
# To add a new entry:
#   rails slurs:hash[word]    # generates the hash
#   rails slurs:check[word]   # verifies detection
module SlurHashes
  HASHED_SLURS = Set.new([
    # Hashes of normalized slur words - originals not stored in code
    # Racial/ethnic slurs
    "014f5a1d767aff5e93196bccca1ae84fd0c97dfb827f7ecb9adbe38aefb9255e",
    "038c9ccdd226f5728bd0a945bdbb0a25c0f877f2f36f4092ee8c004e810aa300",
    "044eb98b18769b887d5a0258f675e413058b8e9fc9b9786b418bfc6f03f26c98",
    "08a841e996781e9e77d30a4e4420a8f501a280b00624e6d1224bf54aaff73eba",
    "0be9b885f4a35a18f6af6b1ac0acd7fa4b19993999c3fbf66dd1e3e0c4c753c8",
    "0dcc4d3364433181d36240001a590f771102cc16a3bcc8ced32a9671057f9253",
    "120f6e5b4ea32f65bda68452fcfaaef06b0136e1d0e4a6f60bc3771fa0936dd6",
    "12e6274e4309293e2d480272b49a6c7c73a6a6b22678ba226b533c67006c17d1",
    "158869a97379229b7681efae9d7f9c9214134e836d649ba53477c0c111414d59",
    "16ea09fc78ca83ca502cbcf2377acdf280bf18f61e259153f0868405eedab5ef",
    "1802d081455e60cd8a4e1b5d38d3f8c613662dee16f790e26a2a7a5332764780",
    "1b23806e78cc5127ab34ea7219ac683fc9f568dd743b199d64b6e047f0a683c6",
    "1c79c99d6e1377b8619365087caf7ef8849215887be51578fe7e3dffd0390357",
    "22fc75e65a0e9d34324092a7c6a8dba961853294abca4e5914e60c550f48e0c2",
    "268651b3ece980102f18871fde07189372961e056f858ca147a28d004f876b03",
    "3160c321bcd0c49b6755f1e30c7bfdb9a444db2cb3bba2074dfeb9647ded306b",
    "333f7618092958c75b8c5af6f1ec77b42803922a0fc6ff1570a8af3a3aab3b4a",
    "33740da8a87dc7defbdbb7d06549dd8d82a33000a25293ceb9af687eb16bef22",
    "402f7ebd98864afed4817ff4718d357dbfa95458aa4236d6c5959536956fa4e5",
    "43508b5c03b8b8cee3ee7ad37cb95aa181c319f129d0bb42de1a1d8f57ec735e",
    "457f002f9240a36acd225762bebf1f99ea6793160e60ca37be382c52cc85ecde",
    "45cd3e1bb472d8e285a160a95f6409ec5ce86102e9caaaf0b63fc11db04ab559",
    "469c0fdb6020d4bffe12ec93e76150a08ef02e116fc856a84b24eb02a1d1a155",
    "4761f877ca09254886ad084efb618dde8e2f4c9775a4428ee2bffcd634497b77",
    "4dd131cd13b66b64285cae12af2367c176c4d40205169fe2c952a8ad4c464493",
    "53434d99c5ad7674936a19d3e4e768e7300fc00a19307b8d7e8faf22a4f047f0",
    "5e02602b7569c2c288acc7efedd370db866afb91751ac0614f908deb57d46687",
    "619bc82e0d200e4ad4e6bd13e7b068c7da60e10b794565db20ff8caa43e38081",
    "66415f8ce37b74a5892088bb06130bf5f6d8a155b6600055372b28e003887709",
    "68c85b220ba24471d7e0bb131a1ea8a1c4d2b3b2ff132fff9d167fd64d39cfae",
    "6ade381b3aa4b14afeee38dc48ebbf4e8b1871c0357b27cfdb273f60dd432f26",
    "701033ae26411908f31114d29190f60cdd9bf3e720e303f793882af5763b688f",
    "7991d51fe699b9e7da97be2edcc528fc5a364e88e6c0e5d83cc96f4e865a64c2",
    "7d2969e37aa4ff6030ee5b5b9e60f8689a5bab0a4a24b432d7ee4be157e5f6bd",
    "7dc7079a7ceee46ef2e5006b3d0961a769656dfa3a00256bf09d03d0ca2c6247",
    "82159dd02870c13ec30e4f146db7c317aca568469d0e7e22b8610a2eaa3d3924",
    "8a77f935115693a26a78d39375568b06461b618418fe14b219186effc6bf5f47",
    "94a877e2ce63725ecae04e85d09f50066b42e2c6a2ab3ce92aba7908e0dbd1bf",
    "94acf3bb26da53dbb38a9950b83903f57650b13dbbdc3b85aba044f153bfb64b",
    "98b52c4b6b7d1f48e7477a5ccc10955dd195d0ac5a38c8281bfeb08762634909",
    "9d57436661e1dce7d4506378319b1d62c6677bae3794b9cb048cbb5a9844d478",
    "a3f89e63505b829d8726a98421e1b9040668d70a0e4e668372776704462b7762",
    "ad412adb493df95a99a922c23990a35d1a166f6ca5d2b46ea360df8fea92b0a7",
    "ad64e56f214e89dd1b2570e88877c66aa9c90f1d9dc2987a9acc9a85214709fc",
    "b726c4b4a1b4f0116055eb4f0df9c9dbb9363f5722e4c4d7629b5ce8f633ee06",
    "b88fe8a4152298fb851386462f9e2121bcc1be65e4fac95f44246e77f4283fc1",
    "bb209d506bb8b17815af0e50923c3d8f65985dab91083f026f1881a7430c5cc7",
    "bb87adf8aa783887f0874a55a7fce06d5fc60f5886a767c88f75fe5a7611074a",
    "bd331fb1d24298f52943034a243a341877957b895f4372b11babb87262904ed6",
    "be00f1af522eaa99d3dc57b0e27162a5e8963e0e0e8b6cc5734f53d8e64ba2dc",
    "c1b4ed05397df5eebb4ea2e233ce45ce62e56b34d4b37d81f53059291ff741c2",
    "c1cabb6f6e431f9c4dea4c3b3264d6fe3829241d674f3496a2dfff6658f0363e",
    "c3de533e9b7fe63b79f648687a30d2861edd92fe7c3cd1f2c485e0a605367624",
    "ca5941f91508c0d16fc4f25ad7b803d7350f9f396f751404833f05b9193c5ece",
    "cc02032349c833ac5e97bac094560ed40e09acf34cb1978ab7a9840b9bf15b4d",
    "ce20df7259154252a17292c16f62cad01e534ba08ba5496742b65271451d0b91",
    "d0e3cb91d24958c5bca41d3c03b37591b6275df9323003a546682af7b959f733",
    "d27b115fc1ea6db0b984b6ccaf6a5877d1ee83ae7374c020e158efe8f028badf",
    "da0a6b1b9213d48ff10cc45733cc8a925dbd2afb26320ed488ac2efa9a8ae33a",
    "daec0c235d3135fc1c60aee787f784c59c4d53b2041ff2bacd0d3bebda7246a8",
    "dc675e448132fd2a4fed47c1736784e83fe01e8cf137dcf97cca9fc7e337e8b4",
    "e4b3b0b088253e2098ce0bb9bcbb32626330a6f066938e612c1431af1c6a3ae5",
    "e742d17ff490c87e19d0cfbfdb18c691aad9543e5d61498df7a6ba6dc56e3124",
    "e7b98c6aa5b944e0b315d350d423f895ac9e44fb84f1534b18c2572370a67b9e",
    "e9e8b6c5afa7794feb71a4aecadaffbf7f4c2299f7c9659114aeb652de4436e2",
    "eef3bd091670c3447022d619c06ad15de96da72b5a66f28bb8b75d1b1c12a05f",
    "f59e28f8bb6499ddf0521ed7a60aeda00957aeb7ee605caf17a216f7a9a26d08",
    "f9d0d9b18ae9033a5ea36df19bf279b059e887a9ae785db81117bceaecc95933",
    "fb1acd44962209a65826621210c03c0a72e392169f52c2f208efbf3f272f09a2",
    # Homophobic/transphobic slurs
    "050dd98dbff4d26eb0adb91a24c2463cebb99ccc9164cfb53e7950463ec0741c",
    "07dd36cbdf1eae2c6df2e87d28a2f7efbdbdb6a0eca5322bf19f17d2e1d35451",
    "17bde8b4064612e266eaa1b5b1dfa054d1e6dd263f66b392159006d2c9a8ae8a",
    "182abcbc22a2db5eba16bebd8c1827a438087873201909fa6e27a094a47c733c",
    "18ece4e67f171fad3b283f5c9241a6590c357326e2c3e67d80db40a59807d905",
    "1b6903ef741704e1c13d0be3a3f5e917283b499a8f44f1479c2083834d858a82",
    "1c3b086e6fd44be4130558e7f0c281661baa48c41c9729febb34f18f866489de",
    "28a23fc3675d8ece25f25664b026ac5796e4f423f433e87ba84dbae58fb381ce",
    "2a1675ff126377bdbd5df6c25297f8c772bd1519d74a927cfd78be36f3e8a934",
    "32777278958a905b7924d54794b2a9e4a5762b3ec4482203499d3d846182aafd",
    "3b1e0d7c5dd45583867e897943e37a940a7e7321022317dd3deea01963ee365e",
    "3d5d85ce3d95798be5337925007de7efbf70b59e4b42b853299e7e6c03f9f1c7",
    "60c22c644d1194d88322dd8b0329880ce75f308b0dead8dca3e78f6037d3c671",
    "63bd9333b1a0b11da8d0b206c4b86cd2a5be63fb5e7b59cc5ac7131f3a257489",
    "7823795816efe70c1f85e217a84103b783a901a99d9f21a4157240ea03856154",
    "886d51e97ad7931d0d2af8439ca6d9e4887e3c2b469ed247cbd68ceb3649ccde",
    "8a6c98d77c46770652f628b699450c68d69d3779709b342ecf0bd7c02bc8d593",
    "8f5083e3e5c7dc8932f2bf58212f963f3a44752618c96297f82623f736c52738",
    "92a9bf818e7e00021b6d6959f877f5df11b0f989e486db38f35853ebbd552086",
    "956a2746327f96f514783a9cd40e072726b01bc7a0cb770b0392f4afde9ad943",
    "9915ba2d822280f22c283df4e76584a40e0119fc58f73c5f84d4fdb04d04fa6f",
    "a77ac6b9073428eaab6e1e128e262eb84f97ff7fc8d8df8b85a3f112dce964c5",
    "bd5cfaf9d04c98084f7aa14782a95641d5aa051d591b59217c1beb5ef03713bb",
    "c28b21f8dafcab42143fd902b0e795649cd061f2fcfb6f96b60740041738e146",
    "e082c0043c2d3e3c816f764ab08513e6fd4aadf4075fc84a427340cf7ba0c6db",
    "eb6fc2200c58c67db2bcc0d53d8a73ffc80c39acd44b107fb303bf4c072886b2",
    # Ableist slurs
    "158869a97379229b7681efae9d7f9c9214134e836d649ba53477c0c111414d59",
    "63a0f641d758652a2062b6f4a0b48419fd38a1dbc0e20067760d1ea407eee3d9",
    "64a59be5fceb487e6a7430b4da13fdcbdd53107588aef20b01c25451c87fd17e",
    "bd331fb1d24298f52943034a243a341877957b895f4372b11babb87262904ed6",
    "c1cabb6f6e431f9c4dea4c3b3264d6fe3829241d674f3496a2dfff6658f0363e",
    "ddef9cb7892c78048958b101f8857965efe4e76d8bb41e5e9ce9fe0edc0ded96",
    "fe3769d8196e46e3019d49c4c4147a476bb821e968f20b140f63417cec83f939",
    # Cyrillic/international slurs
    "11ee63a73ffec0f06ca81f1c53f251a7e16ce4f504f68067d0b5476cf029e6f5",
    "2d93e740d65200e3a749b501650e886a6af7194851113e72c98938dfebd8919d",
    "3b57f78282e73b79515e18a056a3b42bb8dd754746a084721494675deb7ad842",
    "4e777d77b7f86ab1a9f050a2270e626c03faeb8e14f687151d968a3cae42eb0d",
    "5e86ab6de377583064f1af6335ccfd87758dea01256cad9e8c63599826eb30b0",
    "6d9ba2670ee9dce9ab6e73d8786f2dd7b42eaedc1d70f7ba9442f437aee329c4",
    "70aafb4266950c0d17c383c4aac35d9f52b14414cd0b66cdc4e8c45f9da2f656",
    "7fa6552a69094d35c239de29799e544ed6d64d22bdcdf48e8d73063ee0e640ec",
    "8ec533f8f121ab5f2b4e108e59dc4b57503bf8c77f2d35a47025de790d81b670",
    "9a1ab5cc6272f27656dc97bf9dc55e7c752daabe072a50dd6aa85673bdf5070a",
    "a0e2ef64487219d5f44f01c84f29a36c0d287c73aaa5df109dcdf42bb02b773a",
    "a2c32337113ef261d84aaaed5d5dcbccfdbb5a57631224d56f64b31454b9f0f5",
    "a7bf072c97a0779f9bd321528767af01bae93173c46e47fe0ad633d181d8f713",
    "bbf8bb7863176009c037b5abd225491b2a8c8ed76f5ad8ed6b0147f82757db0d",
    "d067075bc9d8def2dabf420279f75462cbe63c40d45bfd4f58db3ef1842a1230",
    "d0ffdefe1a95621a1b4d27c50c9aac9eef373bc15caf9cd256e51ab727b6346b",
    "dcb85fcf872ebfc674f0aafa113b3e5d22512eaa922812da940cfc89f1eff676",
    "e84dde508a606a3efca9e890fc31f60bcb07c796ebb94e1cfaff46bebeaeec8b",
    "f1b1d692c74559e2887146b9caa0bcfa3324c5b6a9aee365882f79b46fb4c9de"
  ]).freeze

  class << self
    def hash_word(word)
      Digest::SHA256.hexdigest(word.to_s.downcase.strip)
    end
  end
end
